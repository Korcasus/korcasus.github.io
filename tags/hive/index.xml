<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Hive on Read Write</title>
        <link>https://korcasus.github.io/tags/hive/</link>
        <description>Recent content in Hive on Read Write</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ko</language>
        <lastBuildDate>Fri, 11 Aug 2023 00:09:54 +0900</lastBuildDate><atom:link href="https://korcasus.github.io/tags/hive/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Elasticsearch Spark</title>
        <link>https://korcasus.github.io/p/elasticsearch-spark/</link>
        <pubDate>Fri, 11 Aug 2023 00:09:54 +0900</pubDate>
        
        <guid>https://korcasus.github.io/p/elasticsearch-spark/</guid>
        <description>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;ESê°€ ê²€ìƒ‰ì—”ì§„ì´ë‹¤ë³´ë‹ˆ, ì„¤ì •í•œ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ì¡°ê±´ìœ¼ë¡œ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒ‰ì¸í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê³ , ìƒ‰ì¸ì„ í•˜ê¸°ìœ„í•´ì„œëŠ” ë§ì€ ë¦¬ì†ŒìŠ¤ê°€ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.&lt;br&gt;
ì´ëŸ¬í•œ ì œì•½ì¡°ê±´ìœ¼ë¡œ ì¸í•´, ë§ì€ ì–‘ì˜ ë°ì´í„° ì†ì—ì„œ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ì°¾ì•„ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì¶œí•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ë”°ë¼ì„œ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ì•¼í• í…ë°, ì´ëŸ¬í•œ ìƒí™©ì´ë¼ë©´ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° Hadoopì„ ì‚¬ìš©ì„ ê²€í† í•©ë‹ˆë‹¤.&lt;br&gt;
ë§Œì•½ Elasticsearchì— ì €ì¥í•  ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ì—­í• ì„ íŒ€ì› ë˜ëŠ” ë³¸ì¸ì´ë¼ë©´, ì ì ˆí•œ ë°©ë²•ìœ¼ë¡œ HDFSì— ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ë°ì´í„° ì „ì†¡ì— ëŒ€í•œ ì œì–´ê¶Œì´ ì—†ê³ , Elasticsearchë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?&lt;/p&gt;
&lt;p&gt;ë‹¹ì—°íˆ Elasticsearchì—ì„œ ë°ì´í„° ì¶”ì¶œì„ ê²€í† í•´ì•¼í•  ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
ì´ëŸ¬í•œ ìƒí™©ì— ì‚¬ìš©í•˜ê¸° ì í•©í•œ ë°©ë²•ì„ ì„¤ëª…í•˜ê³ ì í•©ë‹ˆë‹¤.&lt;br&gt;
Sparkì—ì„œ libraryë¥¼ ì‚¬ìš©í•´, Elasticsearch ë°ì´í„°ë¥¼ ETLí•˜ëŠ” ê³¼ì •ì„ Getting Started ì •ë„ì˜ ë‚´ìš©ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;objective&#34;&gt;Objective&lt;/h2&gt;
&lt;p&gt;ESì— ìƒ‰ì¸ë˜ì–´ìˆëŠ” íŠ¹ì • indexë¥¼ Hiveë¡œ ETLí•œë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;required&#34;&gt;Required&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sparkì— ì¡°ê¸ˆì˜ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;li&gt;Elasticsearchì— ì¡°ê¸ˆì˜ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;environment&#34;&gt;Environment&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Scala : 2.12&lt;/li&gt;
&lt;li&gt;Spark : 3.x&lt;/li&gt;
&lt;li&gt;Java : 8&lt;/li&gt;
&lt;li&gt;ElasticSearch : 7.x&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;dependency&#34;&gt;Dependency&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;elasticsearch-hadoop&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;elasticsearch-spark-30_2.12&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;calcite-core&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ElasticSearch 8ë²„ì „ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤ë©´, Release Noteë¥¼ ë³´ê³  ì ì ˆí•œ ë²„ì „ì„ ì°¾ëŠ”ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.&lt;br&gt;
elastic-* ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” 7.17.0 ë²„ì „ ì´ìƒì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.&lt;br&gt;
7.17.0 ë²„ì „ì—ì„œ ì¤‘ìš”í•œ íŒ¨ì¹˜ê°€ ì´ë£¨ì–´ì¡Œê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;calcite-coreëŠ” deserializeí• ë•Œ ì‚¬ìš©í–ˆë˜ê²ƒìœ¼ë¡œ ê¸°ì–µí•©ë‹ˆë‹¤.&lt;br&gt;
ì¶”ê°€í•˜ì§€ì•Šìœ¼ë©´, Dataframeì„ ìƒì„±í•˜ëŠ” ê³¼ì •ì— ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;getting-started&#34;&gt;Getting Started&lt;/h2&gt;
&lt;h3 id=&#34;connect&#34;&gt;Connect&lt;/h3&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/spark.html#spark-sql&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ê°€ì´ë“œ&lt;/a&gt;ëŒ€ë¡œ í•˜ë©´ Spark SQLì„ ì‚¬ìš©í•  ìˆ˜ìˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ Spark SQLì€ êµ¬ì¡°í™”ëœ ë°ì´í„°ì´ë¯€ë¡œ, ë™ì¼í•œ ë°ì´í„°êµ¬ì¡°ë¥¼ ê°€ì§€ì§€ì•Šì„ê²½ìš° ë¬¸ì œê°€ ìƒê¸¸ìˆ˜ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;êµ¬ë²„ì „ì€(Spark version &amp;lt; 3.x) ì„¤ëª…í•˜ì§„ ì•Šê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;Spark3ë²„ì „ë¶€í„°ëŠ” SparkSessionì„ ìƒì„±í•´ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;br&gt;
Sessionì„ ìƒì„±í•˜ë©´ì„œ, ì—°ê²°í•˜ê³ ì í•˜ëŠ” esì˜ ì •ë³´ë“¤ì„ ì…ë ¥í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html#_essential_settings&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Configuration&lt;/a&gt;ì„ ì½ìœ¼ë©´ ìƒì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ESì— ì—°ê²°í•˜ê¸°ìœ„í•´ì„œëŠ” ì•„ë˜ì˜ 2ê°œëŠ” í•„ìˆ˜ì ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;es.nodes&lt;/li&gt;
&lt;li&gt;es.port&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì¸ì¦ì´ í•„ìš”í•˜ê±°ë‚˜, httpsì—°ê²°ì´ í•„ìš”í•˜ì§€ì•Šì„ ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ì„¤ì •ì„ ì…ë ¥í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;es.net.http.auth.user&lt;/li&gt;
&lt;li&gt;es.net.http.auth.pass&lt;/li&gt;
&lt;li&gt;es.net.ssl&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì¸ì¦ê³¼ ê´€ë ¨ëœ ë‚´ìš©ì€ &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html#_secure_settings&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ë§í¬&lt;/a&gt;ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
ì œí•œëœ í™˜ê²½ì¸ WANí™˜ê²½ì— êµ¬ì¶•ëœ ESë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ê²½ìš° ì¶”ê°€í•´ì£¼ì–´ì•¼í•˜ëŠ” íŒŒë¼ë¯¸í„°ê°€ ìˆìŠµë‹ˆë‹¤.
ì´ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•  ê²½ìš°, &lt;code&gt;es.nodes&lt;/code&gt; ì— ëª…ì‹œëœ nodesë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ë‹¤ë¥¸ nodeëŠ” íƒìƒ‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;es.nodes.wan.only&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ìƒì„¸ ë‚´ìš©ì€ &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html#_input&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ë§í¬&lt;/a&gt;ì—ì„œ ë³´ì‹¤ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ìœ„ì™€ê°™ì€ ì„¤ì • ì •ë³´ë“¤ì„ ëª¨ë‘ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;master&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparkConfiguration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMaster&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;appName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparkConfiguration&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getAppName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.nodes&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;es-nodes&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.port&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;es-port&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.net.http.auth.user&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.net.http.auth.pass&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.nodes.wan.only&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark.es.net.ssl&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ElasticSearch hadoopì€ Sparkê°€ ì ‘ê·¼í•´ì˜¬ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ 4ê°€ì§€ ì œê³µí•˜ê³ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Native RDD&lt;/li&gt;
&lt;li&gt;Spark Streaming&lt;/li&gt;
&lt;li&gt;Spark SQL&lt;/li&gt;
&lt;li&gt;Spark Structured Streaming&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ìœ„ 4ê°€ì§€ë¥¼ ì„±ê²©ì— ë”°ë¼ ë‚˜ëˆ„ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Structured vs Unstructured&lt;/li&gt;
&lt;li&gt;Streaming vs Non-Streaming(Batch)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Streamingì„ ê³ ë ¤í•´ì•¼í•œë‹¤ë©´, Spark Streamingì´ë‚˜ Spark Structured Streamingì„ ê²€í† í•´ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ê·¸ê²Œì•„ë‹ˆë¼ë©´ Native RDDë‚˜ Spark SQLì„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ESë°ì´í„°ë¥¼ Hiveì—ì„œ ì‚¬ìš©í•  ëª©ì ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì´ë¯€ë¡œ, Structure í˜•íƒœë¥¼ ê°€ì§ˆìˆ˜ ìˆëŠ” Spark SQLë¡œ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
1.5 ì´ìƒë¶€í„°ëŠ” ì•„ë˜ì²˜ëŸ¼ Dataframeì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (1.5 ì´ì „ ë²„ì „ì€ ê°€ì´ë“œ ë¬¸ì„œë¥¼ í†µí•´ í™•ì¸í•´ ì£¼ì„¸ìš”.)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scala&#34; data-lang=&#34;scala&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;spark/index&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì˜ˆì‹œëŠ” Javaë„ ìˆê¸´í•˜ì§€ë§Œ, Scalaë¡œ ìœ„ì£¼ë¡œ ì„¤ëª…í•˜ëŠ”ê²Œ ëŒ€ë‹¤ìˆ˜ì…ë‹ˆë‹¤.&lt;br&gt;
ìœ ì§€ ë³´ìˆ˜ë¥¼ ìœ„í•´ Java Projectë¡œ ì§„í–‰í•´ì•¼í–ˆê¸°ë•Œë¬¸ì—, ì‚¬ìš© ì˜ˆì‹œëŠ” ì•ìœ¼ë¡œ Javaë¡œ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                              &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                              &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;template_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ìœ„ì™€ê°™ì€ ë°©ë²•ìœ¼ë¡œ DataFrame ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ë§Œì•½ì— Java DataFrame ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cfg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Maps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;newHashMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// cfgëŠ” configurationì„ ì¶”ê°€í•˜ê¸°ìœ„í•œ ê°ì²´ì…ë‹ˆë‹¤.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es.read.metadata&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;JavaEsSparkSQL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;esDF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;template_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;read-from-es&#34;&gt;Read from ES&lt;/h3&gt;
&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ì„¤ëª…ë“œë¦° ë°©ë²•ì„ í†µí•´ DataFrameì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ì œëŠ” ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ ì‚¬ìš©í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ìš°ì„ ì€ DataFrameì— ì–´ë–¤ ë°ì´í„°ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ì•„ë˜ì™€ ê°™ì´ printSchema()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´, DataFrameì´ ì–´ë–¤ êµ¬ì¡°ë¥¼ ê°–ì¶”ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;printSchema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;column1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;column2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;indexì— ì„¤ì •ëœ mappingì •ë³´ë¥¼ í† ëŒ€ë¡œ DataFrameì˜ Schemaë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.&lt;br&gt;
ì—¬ê¸°ê¹Œì§€ ì§ì ‘ ì§„í–‰í•´ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ, document idì™€ ê°™ì€ metadataê°€ ì—†ìŠµë‹ˆë‹¤.
ì´ë¶€ë¶„ì€ ì¢€ ì˜ì•„í•˜ê¸´ í•˜ì§€ë§Œ, &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html#_metadata_when_reading_from_elasticsearch&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ì„¤ì •ê°’&lt;/a&gt;ì„ ì¶”ê°€í•˜ë©´ ì‰½ê²Œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es.read.metadata&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;template_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;printSchema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;column1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;column2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_metadata&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;map&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nullable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;|--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valueContainsNull&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ë˜ í•œê°€ì§€ ì˜ì•„í•œ ì ì´ ìˆì„ ê²ë‹ˆë‹¤. array í•„ë“œëŠ” ì–´ë–»ê²Œ ë˜ëŠ”ê±°ì§€? ğŸ¤”&lt;br&gt;
mappingì—ëŠ” array íƒ€ì…ì„ ì§€ì •í•´ì¤„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/reference/7.17/array.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ê°€ì´ë“œ&lt;/a&gt; ë¬¸ì„œë¥¼ ì‚´í´ë´ë„ elementì— ì‚¬ìš©ë˜ëŠ” ë°ì´í„° íƒ€ì…ì„ ëª…ì‹œí•˜ë„ë¡ ì•ˆë‚´í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
DataFrame Schemaê°€ ì˜ëª» ì§€ì •ë˜ì„œ, íŒŒì‹± ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ? ì§ˆë¬¸ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.&lt;br&gt;
ì´ ë¶€ë¶„ë„ ë§ˆì°¬ê°€ì§€ë¡œ ì„¤ì •ìœ¼ë¡œ í•´ê²°ê°€ëŠ¥í•˜ê²Œë” ë§Œë“¤ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì €ë„ ì´ ë¬¸ì œë¥¼ ê²ªì—ˆë‹¤ë³´ë‹ˆ, &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html#cfg-field-info&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ì„¤ì •&lt;/a&gt;ìœ¼ë¡œ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es.read.metadata&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;es.read.field.as.array.include&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;productMapping,sellerMapping&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;template_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì–´ë–¤ í•„ë“œë¥¼ array ë¡œ íŒŒì‹±í•´ì•¼í•˜ëŠ”ì§€ ëª…ì‹œí•˜ì˜€ìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ê²ƒê³¼ ë°˜ëŒ€ë¡œ arrayë¡œ íŒŒì‹±í•˜ë©´ ì•ˆë˜ëŠ” í•„ë“œë¥¼ ëª…ì‹œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;es.read.field.as.array.exclude&lt;/code&gt; ê°’ì„ ì„¤ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;br&gt;
ESì— ì €ì¥ëœ ë°ì´í„°ë“¤ê³¼ mappingì˜ ë°ì´í„° íƒ€ì…ì´ ë¶ˆì¼ì¹˜ í•˜ì§€ì•ŠëŠ” ì´ìƒ, ì—¬ê¸°ê¹Œì§€ ì§„í–‰í–ˆë‹¤ë©´ ESë°ì´í„°ë¥¼ íŒŒì‹±í•˜ëŠ”ë° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;br&gt;
DataFrameì„ ì§ì ‘ Handlingí•  ìˆ˜ë„ ìˆì§€ë§Œ, ì„ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•  Viewë¥¼ ìƒì„±í•´ì£¼ë©´ ì•„ë˜ì²˜ëŸ¼ SQLì„ ì‚¬ìš©í•  ìˆ˜ë„ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;createTempView&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tmp_front&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filtered_df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;select _metadata, &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;,&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;columns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34; from tmp_front&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;customize-field&#34;&gt;Customize Field&lt;/h3&gt;
&lt;p&gt;ESì— ìˆëŠ” ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼, ë³€í™˜ì„ ê±°ì³ ì‚¬ìš©í•´ì•¼í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì˜ˆë¥¼ë“¤ë©´ Serialized Json Stringì´ í•„ë“œë¡œ ì¡´ì¬í•œë‹¤ë©´, Deserializeí•œ í›„ì— Mapìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ë¬¼ë¡  ì˜ˆì‹œëŠ” ì €ì˜ ì‚¬ë¡€ì…ë‹ˆë‹¤. ã…&lt;br&gt;
Processingì„ í•˜ê¸°ì— ì•ì„œ Sparkê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ ê°„ë‹¨íˆ ì´ì•¼ê¸°í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ìš°ë¦¬ê°€ ì‘ì„±í•œ í”„ë¡œê·¸ë¨ì€ Sparkì—ì„œ Driverë¼ê³  ë¶ˆë¦¬ë©°, ë‹¤ìˆ˜ì˜ ì›Œì»¤ ê´€ë¦¬ ë° ìš´ì˜í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ê´€ë¦¬ ë° ëª¨ë‹ˆí„°ë§ê³¼ ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.&lt;br&gt;
ë°ì´í„° ì¡°íšŒì™€ ë¶„ì‚°ì²˜ë¦¬ì˜ ê²½ìš°ì—ëŠ” Worker(Executor)ê°€ í• ë‹¹ë˜ì–´ ì²˜ë¦¬í•˜ê²Œë©ë‹ˆë‹¤. ë‹¤ìˆ˜ì˜ Workerê°€ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— í° ê·œëª¨ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ë”ë¼ë„ ë¹ ë¥¸ì‹œê°„ì•ˆì— ì²˜ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;br&gt;
ë¬¼ë¡  Workerì—ì„œ ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ Driverì—ì„œ ì²˜ë¦¬í•˜ê²Œ í• ìˆ˜ëŠ” ìˆì§€ë§Œ, ìƒë‹¹íˆ ëŠë ¤ì§ˆ ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
Spark SQLë¡œ ë§Œë“  DataFrameì€ Sparkì˜ Workerì— ë¶„ì‚°ë˜ì–´ ì €ì¥ë˜ì–´ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ë”°ë¼ì„œ í•„ë“œì˜ Processingì„ ìœ„í•´ì„œëŠ” ë‹¤ìˆ˜ì˜ Workerì—ì„œ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì´ë¥¼ ìœ„í•´ì„œëŠ” Serializable Interfaceë¡œ êµ¬í˜„í•´ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ì´ë¯¸ ë§Œë“¤ì–´ì§„ Classë¥¼ Serializableë¡œ ë³€ê²½í•˜ëŠ” ì‘ì—…ì€ ì‰½ì§€ì•Šì„ ê²ë‹ˆë‹¤.&lt;br&gt;
ëŒ€ì•ˆìœ¼ë¡œ static functionìœ¼ë¡œ ë§Œë“¤ì–´ì„œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì˜ˆì‹œë¡œ ë§ì”€ë“œë ¸ë˜ Deserializeí•œ í›„ ì»¬ëŸ¼ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ê³¼ì •ì„ ë‚˜ì—´í•˜ë©´ ì•„ë˜ì™€ ìˆœì„œëŒ€ë¡œ ë˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;í•„ë“œë¥¼ ê°€ê³µí•  ìˆ˜ ìˆëŠ” UDF(User Defined Function)ì„ static functionìœ¼ë¡œ ë§Œë“ ë‹¤.&lt;/li&gt;
&lt;li&gt;SparkSessionì— UDF ë“±ë¡&lt;/li&gt;
&lt;li&gt;DataFrameì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì¶”ê°€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ìœ„ì˜ 3ê°€ì§€ ê³¼ì •ì„ ì½”ë“œë¡œ ì‘ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;UDF1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jsonStringToMap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jsonStr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;ObjectMapper&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mapper&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ObjectMapper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mapper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;readValue&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jsonStr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TypeReference&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@Override&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RepeatStatus&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StepContribution&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;contribution&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ChunkContext&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunkContext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Exception&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;udf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;register&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;jsonStringToMap&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jsonStringToMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DataTypes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;createMapType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DataTypes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;StringType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DataTypes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;StringType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;createTempView&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tmp_front&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Row&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filtered_df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparkSession&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;select _metadata, &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;,&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;columns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34; from tmp_front&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;filtered_df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filtered_df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;withColumn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dataFieldMap&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;functions&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;callUDF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;jsonStringToMap&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;filtered_df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;col&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dataFields&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì´ë ‡ê²Œ UDF í•¨ìˆ˜ë¥¼ ê° Workerì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ë¨ìœ¼ë¡œì„œ, ë¶„ì‚°ì €ì¥ëœ DataFrameì„ ë³‘ë ¬ë¡œ Processingí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;ì—¬ê¸°ê¹Œì§€ Sparkë¥¼ ì‚¬ìš©í•´ Elasticsearch ë°ì´í„°ë¥¼ Hiveì— ì—°ë™í•˜ëŠ” ê³¼ì •ê¹Œì§€ ì§„í–‰í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
4ê°€ì§€ ë°©ì‹ì¤‘ ì €ì˜ ë‹ˆì¦ˆì— ë§ëŠ” Spark-SQLë§Œ ì„¤ëª…ë“œë ¸ì§€ë§Œ, ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ë‚˜ë¨¸ì§€ë„ ë¹„ìŠ·ë¹„ìŠ·í•©ë‹ˆë‹¤.
ìƒí™©ì— ë§ëŠ” ì ì ˆí•œ ë°©ì‹ì„ ì„ íƒí•´ì„œ ì§„í–‰í•˜ì‹œë©´ ë˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;Guide ë¬¸ì„œë§Œ ë³´ê³  ì‹œì‘ì„ í—€ëŠ”ë°, ì‹¤ë ¥ì´ ë¶€ì¡±í•´ì„œ ê·¸ëŸ°ì§€ ì‚½ì§ˆ ì¢€ í–ˆì—ˆìŠµë‹ˆë‹¤. ğŸ« &lt;br&gt;
ì´ì™€ ë¹„ìŠ·í•œ ì¼ì„ í•˜ì…”ì•¼í•˜ëŠ” ë¶„ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ í•´ì„œ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê²¨ë´…ë‹ˆë‹¤.&lt;br&gt;
ê°ì‚¬í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Spark-SQL ì—°ë™ ê³µì‹ë¬¸ì„œ : &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/spark.html#spark-sql&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/spark.html#spark-sql&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Configuration ê³µì‹ë¬¸ì„œ : &lt;a class=&#34;link&#34; href=&#34;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.elastic.co/guide/en/elasticsearch/hadoop/7.17/configuration.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Dependency
&lt;ul&gt;
&lt;li&gt;Elasticsearch-spark-30 : &lt;a class=&#34;link&#34; href=&#34;https://mvnrepository.com/artifact/org.elasticsearch/elasticsearch-spark-30&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://mvnrepository.com/artifact/org.elasticsearch/elasticsearch-spark-30&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Elasticsearch-hadoop : &lt;a class=&#34;link&#34; href=&#34;https://mvnrepository.com/artifact/org.elasticsearch/elasticsearch-hadoop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://mvnrepository.com/artifact/org.elasticsearch/elasticsearch-hadoop&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Hive Kafka Integration 3</title>
        <link>https://korcasus.github.io/p/hive-kafka-integration-3/</link>
        <pubDate>Thu, 01 Dec 2022 22:45:04 +0900</pubDate>
        
        <guid>https://korcasus.github.io/p/hive-kafka-integration-3/</guid>
        <description>&lt;h2 id=&#34;ê°œìš”&#34;&gt;ê°œìš”&lt;/h2&gt;
&lt;p&gt;ì•ì„œ ì„¤ëª…í•´ì™”ë˜ ë‚´ìš©ê³¼ëŠ” ë°˜ëŒ€ë¡œ Hiveì—ì„œ Kafkaì— ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ëŠ” ê³¼ì •ì„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
Kafka ì…ì¥ì—ì„œëŠ” Hiveê°€ Producer ì—­í• ì„ ìˆ˜í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;ë‹¨ì &#34;&gt;ë‹¨ì &lt;/h3&gt;
&lt;p&gt;Hiveì—ì„œ Kafkaë¡œ ì „ì†¡í• ë•Œ í•„ìˆ˜ì ì¸ ê¸°ëŠ¥ë“¤ì€ ì œê³µí•˜ë‹¤ë³´ë‹ˆ, ì¼ë°˜ì ì¸ ê²½ìš°ì—ëŠ” ì‚¬ìš©í•˜ëŠ”ë° ë¬¸ì œ ì—†ìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ì¼ë¶€ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ì•ŠëŠ”ë°, ê·¸ ì¤‘ í•˜ë‚˜ê°€ Headerì…ë‹ˆë‹¤.&lt;br&gt;
Headerë„ ë§Œë“¤ì–´ì£¼ì–´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ë©´, Hive ë§ê³  ë‹¤ë¥¸ Applicationì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/7b3ecf617a6d46f48a3b6f77e0339fd4ad95a420/kafka-handler/src/java/org/apache/hadoop/hive/kafka/KafkaWritable.java&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;KafkaWritable&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://kafka.apache.org/documentation/#record&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Kafka Record ê³µì‹ë¬¸ì„œ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;kafka-metadata-ì£¼ì˜ì‚¬í•­&#34;&gt;kafka metadata ì£¼ì˜ì‚¬í•­&lt;/h3&gt;
&lt;p&gt;Producerì—ì„œ Kafkaë¡œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í• ë•ŒëŠ” ë©”íƒ€ ë°ì´í„°ë“¤ì„ í¬í•¨ì‹œì¼œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í¬í•¨ì‹œí‚¤ì§€ ì•Šì„ ê²½ìš°, Kafkaì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³  ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
Hiveì—ì„œë„ ë§ˆì°¬ê°€ì§€ ì…ë‹ˆë‹¤. &lt;code&gt;__timestamp&lt;/code&gt;, &lt;code&gt;__partition&lt;/code&gt;, &lt;code&gt;__offset&lt;/code&gt;ì€ kafkaì—ì„œ ê¸°ë¡í•˜ëŠ” ì •ë³´ì´ë¯€ë¡œ ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•˜ë©´ Kafkaì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__timestamp&lt;/code&gt; : -1&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__partition&lt;/code&gt; : null&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__offset&lt;/code&gt; : -1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;í•˜ì§€ë§Œ &lt;code&gt;__key&lt;/code&gt;ëŠ” ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°’ì˜ ë²”ìœ„ëŠ” í•œì •ì ì´ë‹¤ë³´ë‹ˆ ì„ íƒì§€ê°€ ì œí•œì ì´ì§€ë§Œ, ì‹ ì¤‘í•˜ê²Œ ì„¤ì •í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.&lt;br&gt;
KafkaëŠ” &lt;code&gt;key&lt;/code&gt;ë¥¼ &lt;code&gt;partition&lt;/code&gt;ì„ ê²°ì •í•˜ëŠ”ë° ì‚¬ìš©í•˜ë¯€ë¡œ ë©”ì‹œì§€ ë¶„ì‚°ì— ì˜í–¥ì„ ë¯¸ì¹ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  &lt;code&gt;cleanup.policy&lt;/code&gt; ì„¤ì •ê°’ì— ë”°ë¼ &lt;code&gt;key&lt;/code&gt; í™œìš©ì—¬ë¶€ê°€ ê²°ì •ë©ë‹ˆë‹¤.&lt;br&gt;
Kafkaì—ì„œ keyê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë™ì¼í•œ partitionì— ë„£ì–´ì£¼ëŠ” ì—­í• ì„ ìˆ˜í–‰í•˜ê³  ìˆìœ¼ë©° , &lt;code&gt;log.cleanup.policy = compact&lt;/code&gt; ë¡œ ì„¤ì •í• ê²½ìš° keyë¥¼ í™œìš©í•˜ê¸° ë•Œë¬¸ì— byte arrayë¡œ ë„£ì–´ì£¼ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Integer to byte array : cast(cast(1 AS STRING) AS BINARY)&lt;/li&gt;
&lt;li&gt;String to byte array :  cast(&amp;lsquo;1&amp;rsquo; AS BINARY)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;json-í…ŒìŠ¤íŠ¸-ì¼€ì´ìŠ¤&#34;&gt;JSON í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤&lt;/h2&gt;
&lt;p&gt;JSON í¬ë§· ë©”ì‹œì§€ë¥¼ Kafkaì— ì „ì†¡í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;í† í”½-ìƒì„±&#34;&gt;&lt;strong&gt;í† í”½ ìƒì„±&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ì €ì¥í•´ë‘˜ í† í”½ì„ ìƒì„±í•©ë‹ˆë‹¤.&lt;br&gt;
ì•„ë˜ì˜ ì˜ˆì‹œëŠ” Kafka ì„¤ì¹˜ì‹œ í•¨ê»˜ ì œê³µë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ topicì„ ë§Œë“­ë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;./kafka-topics.sh --create --topic &amp;quot;${í† í”½í† í”½}&amp;quot; --replication-factor 1 --partitions 1 --bootstrap-server &amp;quot;{ì„œë²„ì„œë²„}&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;í…Œì´ë¸”-ìƒì„±&#34;&gt;&lt;strong&gt;í…Œì´ë¸” ìƒì„±&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;Kafkaì— ì „ì†¡í•  topicì„ ë§Œë“¤ì–´ë³´ì•˜ìœ¼ë‹ˆ, ì´ì œëŠ” ì‹¤ì œ ì „ì†¡ì—­í• ì„ ìˆ˜í–‰í•´ì¤„ tableì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤. &lt;br&gt;
Kafka Handlerë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ &lt;code&gt;KafkaStorageHandler&lt;/code&gt;ë¥¼ ì§€ì •í•´ì¤ë‹ˆë‹¤.&lt;br&gt;
TBLPROPERTIESì—ëŠ” ì•ì„œ ì„¤ëª…ë“œë ¸ë˜ ê¸€ê³¼ ë¹„ìŠ·í•˜ê²Œ ì§„í–‰í•©ë‹ˆë‹¤.&lt;br&gt;
ë‹¤ë§Œ, ë©”ì‹œì§€ ì „ì†¡í•˜ëŠ” ì—­í• ì´ë‹ˆ consumerê°€ ì•„ë‹Œ producerë¡œ ì§€ì •í•´ì¤ë‹ˆë‹¤.&lt;br&gt;
ì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.serde.class&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org.apache.hadoop.hive.serde2.JsonSerDe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${í† í”½í† í”½}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${ì„œë²„ì„œë²„}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.producer.security.protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PLAINTEXT&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;í…ŒìŠ¤íŠ¸-ë°ì´í„°-ì „ì†¡&#34;&gt;&lt;strong&gt;í…ŒìŠ¤íŠ¸ ë°ì´í„° ì „ì†¡&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ë§Œë“¤ì–´ì¤€ í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì…ë ¥í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. &lt;br&gt;
í…Œì´ë¸”ì— ëª…ì‹œí•œ ì»¬ëŸ¼ì¸ &lt;code&gt;id&lt;/code&gt;, &lt;code&gt;value&lt;/code&gt;ì— ëŒ€í•œ ê°’ì„ í•„ìˆ˜ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤. &lt;br&gt;
ê·¸ ì™¸ì—ëŠ” Kafka MetataData ì´ë©° key, partition, offset, timestamp ìˆœì„œëŒ€ë¡œ ìƒê°í•˜ê³  ë„£ì–´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;insert into test_export_to_kafka values (&#39;1&#39;, &#39;1&#39;, null, null, -1, -1);&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;only-long-type-í…ŒìŠ¤íŠ¸-ì¼€ì´ìŠ¤&#34;&gt;ONLY LONG TYPE í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤&lt;/h2&gt;
&lt;p&gt;ì´ë²ˆì—ëŠ” JSONì´ ì•„ë‹Œ PLAIN TEXT Formatìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•´ë³´ë„ë¡í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;í† í”½-ìƒì„±-1&#34;&gt;&lt;strong&gt;í† í”½ ìƒì„±&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ì•ì„œ ì„¤ëª…ë“œë ¸ë˜ JSON í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.&lt;br&gt;
í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ì €ì¥í•´ë‘˜ í† í”½ì„ ìƒì„±í•©ë‹ˆë‹¤.&lt;br&gt;
ì•„ë˜ì˜ ì˜ˆì‹œëŠ” Kafka ì„¤ì¹˜ì‹œ í•¨ê»˜ ì œê³µë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ topicì„ ë§Œë“­ë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;./kafka-topics.sh --create --topic &amp;quot;${í† í”½í† í”½}&amp;quot; --replication-factor 1 --partitions 1 --bootstrap-server &amp;quot;{ì„œë²„ì„œë²„}&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;í…Œì´ë¸”-ìƒì„±-1&#34;&gt;&lt;strong&gt;í…Œì´ë¸” ìƒì„±&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;Kafka Handlerì™€ TBLPROPERTIESëŠ” ì•ì„œ ì„¤ëª…ë“œë ¸ë˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì™€ ë™ì¼í•˜ê²Œ ì„¤ì •í•©ë‹ˆë‹¤.&lt;br&gt;
ë‹¤ë§Œ ì´ë²ˆì—” PLAIN TEXT Formatì¸ ë§Œí¼, ì»¬ëŸ¼ì€ í•˜ë‚˜ë§Œ ë§Œë“¤ì–´ ì£¼ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka_long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;bigint&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.serde.class&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${í† í”½í† í”½}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${ì„œë²„ì„œë²„}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.producer.security.protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PLAINTEXT&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;í…ŒìŠ¤íŠ¸-ë°ì´í„°-ì „ì†¡-1&#34;&gt;&lt;strong&gt;í…ŒìŠ¤íŠ¸ ë°ì´í„° ì „ì†¡&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ë§Œë“¤ì–´ë‘” í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì…ë ¥í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
í…Œì´ë¸”ì— ëª…ì‹œí•œ ì»¬ëŸ¼ì¸ &lt;code&gt;id&lt;/code&gt;ì— ëŒ€í•œ ê°’ì„ í•„ìˆ˜ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤. &lt;br&gt;
ê·¸ ì™¸ì—ëŠ” Kafka MetaDataì— ëŒ€í•œ ì •ë³´ë¡œ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ì¶”ê°€í•´ì¤ë‹ˆë‹¤. &lt;br&gt;
&lt;code&gt;insert into test_export_to_kafka_long values (1, null, null, -1, -1);&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;ë™ì¼í•œ-keyë¥¼-ê°€ì§„-ë©”ì‹œì§€ê°€-ë™ì¼í•œ-partitionì—-ë“¤ì–´ê°€ëŠ”-í…ŒìŠ¤íŠ¸&#34;&gt;ë™ì¼í•œ keyë¥¼ ê°€ì§„ ë©”ì‹œì§€ê°€ ë™ì¼í•œ partitionì— ë“¤ì–´ê°€ëŠ” í…ŒìŠ¤íŠ¸&lt;/h2&gt;
&lt;p&gt;Producerë¡œ ì‚¬ìš©í•  Applicationì„ ë§Œë“¤ë•Œ ë³´ë©´, Kafkaì— ì „ì†¡í•  Messageê°€ ì–´ë–¤ Partitionì— ì €ì¥ë ì§€ Partitionerë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ Hiveì—ì„œëŠ” ë³„ë„ë¡œ Partitionerë¥¼ ì§€ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;br&gt;
Default Partitionerë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒìœ¼ë¡œ ìƒê°í•˜ê³  ì§„í–‰í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;Messageì˜ Keyê°€ ë™ì¼í•˜ë‹¤ë©´, ë™ì¼í•œ Partitionì— ë“¤ì–´ê°€ì•¼ í•©ë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ Hiveë¥¼ í†µí•´ ì „ì†¡í•´ë³´ëŠ” ê²ƒì€ ì²˜ìŒì´ê¸° ë•Œë¬¸ì— ë™ì¼í•œ Partitionì— ì „ì†¡ë˜ëŠ”ì§€ í™•ì¸ì´ í•„ìš”í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ê°ê¸° ë‹¤ë¥¸ Keyë¥¼ ê°€ì§„ ì—¬ëŸ¬ê°œì˜ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•œ ë’¤, ì•ì„œ ë³´ë‚¸ ë©”ì‹œì§€ì™€ ë™ì¼í•œ Keyë¥¼ ê°€ì§€ì§€ë§Œ ë‹¤ë¥¸ ë‚´ìš©ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.&lt;br&gt;
ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ì˜ ì¿¼ë¦¬ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka_partition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;INT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.serde.class&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org.apache.hadoop.hive.serde2.JsonSerDe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${í† í”½í† í”½}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;${ì„œë²„ì„œë²„}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.producer.security.protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PLAINTEXT&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kafka&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;topics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;--create --topic ${í† í”½í† í”½} --bootstrap-server {ì„œë²„ì„œë²„} --config &amp;#34;cleanup.policy=compact&amp;#34; --partitions 4 --replication-factor 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INSERT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INTO&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka_partition&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;VALUES&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;BINARY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;binary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;binary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;binary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TEMPORARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_partition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;INT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INSERT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INTO&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_partition&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;VALUES&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INSERT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;INTO&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;table&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka_partition&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CAST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;binary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_partition&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_partition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ê²°ê³¼í™”ë©´ì€ ì²¨ë¶€í•˜ì§€ ì•Šì•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë‹ˆ &lt;br&gt;
ë™ì¼í•œ Keyê°’ì„ ê°€ì§„ê²½ìš°, ë™ì¼í•œ Partitionì— ì €ì¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;ì •ë¦¬&#34;&gt;ì •ë¦¬&lt;/h2&gt;
&lt;p&gt;ì´ë²ˆ ê¸€ì„ í†µí•´ Hive Table ë°ì´í„°ë¥¼ Kafkaë¡œ ì „ì†¡ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì‚¬ì‹¤ ì´ë ‡ê²Œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ”ê²Œ ìœ ì¼í•œ ë°©ë²•ë„ ì•„ë‹ˆê³ , ë‹¤ë¥¸ ì¢‹ì€ ë°©ë²•ë“¤ë„ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;br&gt;
(ì˜ˆë¥¼ ë“¤ë©´ HiveServer2ì— JDBCë¡œ ì—°ê²°í•  ìˆ˜ë„ ìˆê³ , Sparkë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)&lt;br&gt;
ì„¤ëª…í•œ ë‚´ìš©ë“¤ì„ ì½ìœ¼ì…¨ë‹¤ë©´ ì œì•½ì´ ë§ë‹¤ëŠ” ê²ƒì„ ëŠë¼ì…¨ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ê¸°ëŠ¥ ì„¤ëª…ì— ì‘ì„±í•˜ì§„ ì•Šì•˜ì§€ë§Œ, ë‹¨ìˆœíˆ ì „ì†¡í•˜ëŠ” ê²½ìš°ë¼ë©´ ë¬¸ì œì—†ì§€ë§Œ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ JOINí•´ì„œ ë°”ë¡œ ì „ì†¡í•˜ê²Œë” ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤ë©´ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ ë¬¸ì œë¥¼ íšŒí”¼í•˜ê¸°ìœ„í•´ì„œëŠ” ì„ì‹œ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ ë°ì´í„°ë¥¼ ì €ì¥í•œ ë’¤, ì„ì‹œí…Œì´ë¸”ì„ ì‚¬ìš©í•´ ë°ì´í„° ì „ì†¡í•˜ê²Œë” ì¿¼ë¦¬ ì‘ì„±í•´ì•¼í•©ë‹ˆë‹¤.&lt;br&gt;
ì´ ì™¸ì—ë„ ì œê°€ íŒŒì•…í•˜ì§€ ëª»í•œ ì œì•½ì´ ìˆì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ì²˜ëŸ¼ ë§ì€ ì œì•½ì´ ì¡´ì¬í•˜ì§€ë§Œ, ë³„ë„ë¡œ Applicationì„ ë§Œë“¤ í•„ìš”ê°€ ì—†ë‹¤ëŠ”ê²Œ í° ì¥ì  ì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì´ëŸ¬í•œ ë°©ë²•ë„ ì—¬ëŸ¬ ì„ íƒì§€ì¤‘ í•˜ë‚˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ëŠ” ê³„ê¸°ê°€ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤.&lt;br&gt;
ì—¬ê¸°ê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Hive Kafka Integration 2</title>
        <link>https://korcasus.github.io/p/hive-kafka-integration-2/</link>
        <pubDate>Thu, 01 Dec 2022 22:45:01 +0900</pubDate>
        
        <guid>https://korcasus.github.io/p/hive-kafka-integration-2/</guid>
        <description>&lt;h2 id=&#34;ê°œìš”&#34;&gt;ê°œìš”&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://korcasus.github.io/p/hive-kafka-integration-1/&#34; &gt;ì´ì „ ê¸€&lt;/a&gt;ì—ì„œ Kafkaì™€ Hive ì—°ë™ì— ì‚¬ìš©í•˜ëŠ” ì„¤ì •ë“¤ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ì œë¶€í„°ëŠ” Kafkaì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ë“¤ì´ê³ , ì“°ëŠ” ì‘ì—…ì— ëŒ€í•´ì„œ ì„¤ëª…í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
ì´ë²ˆ ê¸€ì—ì„œëŠ” Kafkaì— ìˆëŠ” ë°ì´í„°ë“¤ì„ ì½ì–´ë“¤ì´ëŠ” ê²ƒë¶€í„° ì§„í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
Hiveë¥¼ Kafka Consumerë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²™ë¦¬ë¼ ìƒê°í•˜ì‹œë©´ ì´í•´í•˜ê¸° ì‰¬ìš°ì‹¤ ê²ë‹ˆë‹¤.&lt;br&gt;
ì°¨ì´ì ì´ ìˆë‹¤ë©´, ì¼ë°˜ Consumerì™€ëŠ” ë‹¤ë¥´ê²Œ Consumer Groupìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;json&#34;&gt;JSON&lt;/h2&gt;
&lt;p&gt;Kafkaë¡œë¶€í„° ì½ì–´ë“¤ì¼ ë°ì´í„°ë“¤ì´ json format ì¼ ê²½ìš°ë¥¼ ê°€ì •í•˜ê³ , ì§„í–‰í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;sample-data&#34;&gt;Sample data&lt;/h3&gt;
&lt;p&gt;ì•„ë˜ì™€ ê°™ì€ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ì˜ˆì‹œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…ë“œë¦¬ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
í•„ìš”ì— ë”°ë¼ ë” ë§ì€ í•„ë“œë“¤ì„ ì¶”ê°€í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;value:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;í…Œì´ë¸”-ì •ì˜&#34;&gt;í…Œì´ë¸” ì •ì˜&lt;/h3&gt;
&lt;p&gt;json ìŠ¤í‚¤ë§ˆì™€ ë™ì¼í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” í…Œì´ë¸”ì„ ì •ì˜í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
id í•„ë“œëŠ” ì •ìˆ˜ê°’ì„ ê°€ì§€ê³ , value í•„ë“œëŠ” ë¬¸ìì—´ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
Hiveì—ì„œ ì •ìˆ˜ê°’ì€ &lt;strong&gt;INT&lt;/strong&gt; ë˜ëŠ” &lt;strong&gt;BIGINT&lt;/strong&gt; Data Typeìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë¬¸ìì—´ì€ &lt;strong&gt;STRING&lt;/strong&gt;ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì´ ì •ë³´ë“¤ì„ í† ëŒ€ë¡œ DDLì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;BIGINT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.serde.class&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org.apache.hadoop.hive.serde2.JsonSerDe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;etl.hive.catalog.used&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{brokerì„œë²„}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.consumer.security.protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PLAINTEXT&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;test_export_to_kafka&lt;/code&gt;ì€ í…Œì´ë¸”ëª…ìœ¼ë¡œ, ì›í•˜ëŠ”ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í…Œì´ë¸”ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì»¬ëŸ¼ë“¤ì€ ì½ì–´ë“¤ì¼ json êµ¬ì¡°ëŒ€ë¡œ ì‘ì„±í•´ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;br&gt;
ì»¬ëŸ¼ëª…ì€ json keyì™€ ë™ì¼í•˜ê²Œ ì‘ì„±í•˜ê³ , ì»¬ëŸ¼ì˜ íƒ€ì…ì€ json valueì˜ ë°ì´í„° íƒ€ì…ê³¼ ë™ì¼í•˜ê²Œ ë§ì¶°ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;br&gt;
hive ë°ì´í„° íƒ€ì…ì€ jsonë³´ë‹¤ ë‹¤ì–‘í•˜ë¯€ë¡œ, &lt;a class=&#34;link&#34; href=&#34;https://cwiki.apache.org/confluence/display/hive/languagemanual&amp;#43;types&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ë¬¸ì„œ&lt;/a&gt;ë¥¼ ì°¸ê³ í•´ ì ì ˆí•œ íƒ€ì…ì„ ì„ íƒí•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.  &lt;br&gt;
&lt;code&gt;&amp;quot;kafka.serde.class&amp;quot; = &amp;quot;org.apache.hadoop.hive.serde2.JsonSerDe&amp;quot;&lt;/code&gt;ìœ¼ë¡œ ì§€ì •í•´ì¤Œìœ¼ë¡œì„œ, hiveê°€ jsonë°ì´í„°ë¥¼ deserializeí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;br&gt;
ê·¸ ì™¸ì— íŠ¹ë³„íˆ TBLPROPERTIESì—ì„œ ì‚´í´ë´ì•¼í•  ë‚´ìš©ì€ ì—†ìŠµë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;kafka.topic&lt;/code&gt;ë§Œ ì‚¬ìš©í•˜ê³  ì‹¶ì€ kafka topicëª…ìœ¼ë¡œ ë³€ê²½í•´ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;read&#34;&gt;READ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆë‹¤ë©´, topicì— ë“¤ì–´ìˆëŠ” ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ëŠ”ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆë‹¤ë©´ ì—ëŸ¬ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ê±°ë‚˜, ê° ì»¬ëŸ¼ì´ NULLë¡œ ì¶œë ¥ ë  ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
ì—¬ê¸°ê¹Œì§€ ì„¤ëª…í–ˆë˜ ë‚´ìš©ê³¼ ë‹¤ë¥´ê²Œ ì„¤ì •í•œ ë‚´ìš©ì´ ìˆì§€ì•Šì€ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.&lt;/p&gt;
&lt;h2 id=&#34;text&#34;&gt;TEXT&lt;/h2&gt;
&lt;p&gt;JSONì²˜ëŸ¼ êµ¬ì¡°í™”ëœ ë°ì´í„°ê°€ ì•„ë‹ˆë¼, PLAIN TEXTë¥¼ ì½ì–´ì˜¤ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;sample-data-1&#34;&gt;Sample data&lt;/h3&gt;
&lt;p&gt;PLAIN TEXTë¼, ì˜ˆì œë„ íŠ¹ë³„í•  ê²ƒì€ ì—†ìŠµë‹ˆë‹¤.&lt;br&gt;
ë‹¨ìˆœíˆ ìˆ«ìê°’ì„ ì˜ˆì‹œë¡œ ì‚¬ìš©í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1234
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5678
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;91011
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;í…Œì´ë¸”-ì •ì˜-1&#34;&gt;í…Œì´ë¸” ì •ì˜&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;	&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;BIGINT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.serde.class&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;etl.hive.catalog.used&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{ì„œë²„ì„œë²„}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.consumer.security.protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PLAINTEXT&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì•ì„œ ì„¤ëª…í–ˆë˜ JSON í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.&lt;br&gt;
ë‹¤ë¥¸ì ì´ ìˆë‹¤ë©´ Serdeì™€ ì»¬ëŸ¼ì„ ë‹¤ë¥´ê²Œ ì§€ì •í•´ì¤€ ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
Serdeì˜ ê²½ìš° &lt;code&gt;&amp;quot;kafka.serde.class&amp;quot; = &amp;quot;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&amp;quot;&lt;/code&gt; ë¡œ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;
&lt;h3 id=&#34;read-1&#34;&gt;READ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_export_to_kafka&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆë‹¤ë©´, topicì— ë“¤ì–´ìˆëŠ” ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ëŠ”ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
í•˜ì§€ë§Œ ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆë‹¤ë©´ ì—ëŸ¬ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ê±°ë‚˜, ê° ì»¬ëŸ¼ì´ NULLë¡œ ì¶œë ¥ ë  ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
ì—¬ê¸°ê¹Œì§€ ì„¤ëª…í–ˆë˜ ë‚´ìš©ê³¼ ë‹¤ë¥´ê²Œ ì„¤ì •í•œ ë‚´ìš©ì´ ìˆì§€ì•Šì€ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.&lt;/p&gt;
&lt;h3 id=&#34;kafka-metadata-í™œìš©&#34;&gt;Kafka Metadata í™œìš©&lt;/h3&gt;
&lt;p&gt;Kafkaì—ëŠ” ë©”ì‹œì§€ì™€ í•¨ê»˜ ë©”íƒ€ ë°ì´í„°ë“¤ì´ í•¨ê»˜ ê¸°ë¡ë©ë‹ˆë‹¤.&lt;br&gt;
í…Œì´ë¸”ì„ ì •ì˜í• ë•Œ ë©”íƒ€ ë°ì´í„°ë“¤ë„ ìë™ìœ¼ë¡œ ì»¬ëŸ¼ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. Hiveì—ì„œ ë©”ì‹œì§€ë¥¼ ì½ì–´ì˜¬ë•Œ, ë©”íƒ€ ë°ì´í„°ë„ í•¨ê»˜ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤.&lt;br&gt;
ë©”íƒ€ ë°ì´í„°ê°€ ì»¬ëŸ¼ìœ¼ë¡œ ì •ì˜ë˜ë‹¤ë³´ë‹ˆ, SQL ì¡°ê±´ë¬¸ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì˜ˆë¥¼ ë“¤ë©´ íŠ¹ì • ì‹œê°„ ì´í›„ë¡œ ìœ ì…ëœ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ë˜ê°€, íŠ¹ì • íŒŒí‹°ì…˜ì— ìˆëŠ” ë°ì´í„°ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;__partition&lt;/code&gt;ì™€ &lt;code&gt;__offset&lt;/code&gt;ì˜ ê²½ìš°ì—ëŠ” ì •ìˆ˜ íƒ€ì…ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ê¸° í¸ë¦¬í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ex1) &lt;code&gt;__partition = 0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ex2) &lt;code&gt;__offset &amp;gt; 5000&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;í•˜ì§€ë§Œ &lt;code&gt;__timestamp&lt;/code&gt;ì˜ ê²½ìš°ì—ëŠ” unix_timestampë¥¼ ì‚¬ìš©í•˜ê¸°ì— int64ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤.&lt;br&gt;
ì´ëŠ” ì¼ìƒì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‹œê°„ í‘œê¸°ë°©ì‹ê³¼ ë‹¤ë¥´ê³ , ë³€í™˜ì´ í•„ìš”í•˜ê¸°ì— ì‚¬ìš©í•˜ê¸° ë¶ˆí¸í•©ë‹ˆë‹¤. &lt;br&gt;
í¸í•˜ê²Œ ì¡°ê±´ë¬¸ìœ¼ë¡œ í™œìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì²˜ëŸ¼ ë³€ê²½í•´ì„œ ì‚¬ìš©í•˜ëŠ”ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.&lt;br&gt;
unix_timestampë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš© í•˜ë©´ ë˜ëŠ”ë° ì•„ë˜ ì˜ˆì œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;unix_timestamp(&#39;2022-03-08 00:00:00.000&#39;, &#39;yyyy-MM-dd HH:mm:ss.SSS&#39;) * 1000&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ì²«ë²ˆì§¸ ì¸ìëŠ” ë³€í™˜í•˜ê³  ì‹¶ì€ ì‹œê°„ì„ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;li&gt;ë‘ë²ˆì§¸ ì¸ìëŠ” ì²«ë²ˆì§¸ ì¸ìì— ì…ë ¥í•œ ì‹œê°„í¬ë§·ì„ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ì„ unix_timestampë¡œ ë³€ê²½ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , &lt;code&gt;__timestamp&lt;/code&gt; ë¹„êµ ì—°ì‚°ì„ í•  ìˆ˜ ìˆê²Œë˜ì—ˆìŠµë‹ˆë‹¤. &lt;br&gt;
í•˜ì§€ë§Œ hiveë¡œ í†µí•´ ì½ì–´ë“¤ì¸ &lt;code&gt;__timestamp&lt;/code&gt;ëŠ” ë§ˆì´í¬ë¡œì´ˆ ë‹¨ìœ„ì´ê¸° ë•Œë¬¸ì— ë‹¨ìœ„ë¥¼ ë§ì¶°ì£¼ëŠ” ì¶”ê°€ì—°ì‚°ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;br&gt;
ì´ë•Œë¬¸ì— 1000ì„ ê³±í•˜ì˜€ìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì‚¬ìš© ì˜ˆì œì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ex) &lt;code&gt;unix_timestamp(&#39;2022-03-08 00:00:00.000&#39;, &#39;yyyy-MM-dd HH:mm:ss.SSS&#39;) * 1000 &amp;lt; __timestamp&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ì¶”ê°€ ì˜ˆì œ&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;-- print to UTC timestamp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FROM_UTC_TIMESTAMP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__timestamp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;JST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_kafka_product_received&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;-- print timestamp, unixtime to timestamp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;current_timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;from_unixtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unix_timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;yyyy-MM-dd HH:mm:ss.SSS&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;-- print converted unixtime
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unix_timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2022-03-07 14:00:00.000&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;yyyy-MM-dd HH:mm:ss.SSS&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unix_timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2022-03-07 06:11:41&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;yyyy-MM-dd HH:mm:ss&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ì •ë¦¬&#34;&gt;ì •ë¦¬&lt;/h2&gt;
&lt;p&gt;ì´ë²ˆ ê¸€ì„ í†µí•´ Hiveì—ì„œ Kafkaì— ì €ì¥ëœ JSON ë˜ëŠ” PLAIN-TEXTë¥¼ ì½ì–´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;br&gt;
metadataë¥¼ í•„í„°ë§ ìš©ë„ë¡œ ì‚¬ìš©í•œë‹¤ë©´, Kafkaì— ì›í•˜ëŠ” ì¡°ê±´ì„ ê°€ì§„ ë©”ì‹œì§€ë¥¼ ì†ì‰½ê²Œ ì¶”ì¶œí•´ ë³¼ ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ì•„ì‰¬ìš´ ì ìœ¼ë¡œëŠ” Hiveì— ì €ì¥ë˜ì–´ìˆëŠ” ë‹¤ë¥¸ í…Œì´ë¸”ë“¤ê³¼ joinì´ ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. (ì œê°€ ì‹œë„í–ˆì„ë•ŒëŠ” ì¸ì¦ìœ¼ë¡œ ì¸í•œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.)&lt;br&gt;
ì´ ë•Œë¬¸ì— ì‚¬ìš©ìš©ë„ê°€ ë§ì´ ì œì•½ë˜ì—ˆì§€ë§Œ, ê°œì„ ëœë‹¤ë©´ í™œìš©ë„ê°€ ë†’ì„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ë‹¤ìŒ ê¸€ì—ì„œëŠ” Hiveë°ì´í„°ë“¤ì„ Kafkaë¡œ ì „ì†¡í•˜ëŠ” ê³¼ì •ì„ ê¸°ë¡í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ê°ì‚¬í•©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Hive Kafka Integration 1</title>
        <link>https://korcasus.github.io/p/hive-kafka-integration-1/</link>
        <pubDate>Thu, 01 Dec 2022 22:44:01 +0900</pubDate>
        
        <guid>https://korcasus.github.io/p/hive-kafka-integration-1/</guid>
        <description>&lt;h2 id=&#34;ê°œìš”&#34;&gt;ê°œìš”&lt;/h2&gt;
&lt;p&gt;HiveëŠ” Hadoopì— ì €ì¥ëœ ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë“¤ì„ SQL ë¬¸ë²•ìœ¼ë¡œ ì½ê³  ì“¸ìˆ˜ìˆê²Œ í•´ì£¼ëŠ” data warehouse softwareì…ë‹ˆë‹¤.&lt;br&gt;
ê°„ë‹¨í•˜ê²Œ Hadoopì—ì„œ ë™ì‘í•˜ëŠ” ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ Databaseë¼ê³  ìƒê°í•´ ë³¼ ìˆ˜ ìˆì„ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ê¸°ë³¸ìœ¼ë¡œ HDFSë¥¼ ì§€ì›í•˜ë©°, Hbase ë˜ëŠ” ê¸°íƒ€ DBMSì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ê°œë°©ì ì¸ DataSourcing ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.
Message Queueë¡œ ë§ì´ í™œìš©ë˜ëŠ” Kafkaë„ ì§€ì›í•©ë‹ˆë‹¤. ì´ë²ˆ ì‹œë¦¬ì¦ˆì—ì„œëŠ” Hiveì™€ Kafka ì—°ë™ì„ ìœ„í•œ ì„¤ì •ë¶€í„° Messageë¥¼ ì½ê³  ì“°ëŠ” ê³¼ì •ê¹Œì§€ ê¸°ë¡í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì´ë²ˆ ê¸€ì—ì„œëŠ” ì‚¬ìš©í• ë•Œ í•„ìš”í•œ ì„¤ì •ë“¤ê³¼ ì•Œì•„ì•¼í•˜ëŠ” ì •ë³´ë“¤ì„ ìœ„ì£¼ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤.
ì‚¬ìš© ì˜ˆì‹œê°€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ ë‹¤ìŒ ê¸€ì„ ì½ì–´ì£¼ì„¸ìš”.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/master/kafka-handler/README.md&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ê³µì‹ë¬¸ì„œ&lt;/a&gt;ë¥¼ í† ëŒ€ë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;br&gt;
ë¬¸ì„œì—ëŠ” ì‘ì„±ë˜ì–´ìˆì§€ì•Šìœ¼ë‚˜, ì‚¬ìš©í•˜ë ¤ë©´ ì¶”ê°€ë¡œ ì•Œì•„ì•¼í•  ë‚´ìš©ê³¼ ì§ì ‘ í…ŒìŠ¤íŠ¸í•œ ì˜ˆì œë“¤ì„ ìƒì„¸íˆ ê¸°ë¡í•˜ê³ ì í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Hive 3.x ë²„ì „ì—ì„œ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ì„¤ì¹˜&#34;&gt;ì„¤ì¹˜&lt;/h2&gt;
&lt;p&gt;ì‚¬ì‹¤ ë³„ë„ì˜ ì„¤ì¹˜ëŠ” í•„ìš”í•˜ì§€ì•ŠìŠµë‹ˆë‹¤.&lt;br&gt;
ê³µì‹ë¬¸ì„œë¥¼ í•œë²ˆ ì‚´í´ë³´ì…¨ë‹¤ë©´ ì•„ì‹œê² ì§€ë§Œ, Hiveì— ì´ë¯¸ ë‚´ì¥ ë˜ì–´ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì–´ë–»ê²Œ í•  ì§€ ìƒìƒì´ ì•ˆë ìˆ˜ë„ ìˆì§€ë§Œ, SQLì„ ì‚¬ìš©í•˜ë©´ Kafkaì— ì—°ë™ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;í…Œì´ë¸”-ìƒì„±&#34;&gt;í…Œì´ë¸” ìƒì„±&lt;/h2&gt;
&lt;p&gt;Hiveì™€ Kafkaë¥¼ ì—°ë™í•´ì£¼ê¸° ìœ„í•´ì„œëŠ” ì—°ê²°ê³ ë¦¬ë¥¼ ë§Œë“¤ì–´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.&lt;br&gt;
Springì—ì„œëŠ” Binderì™€ Bindingì„ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ ì—°ê²°ê³ ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë“¯ì´, Hiveì—ì„œëŠ” &lt;code&gt;StorageHandler&lt;/code&gt;ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;StorageHandler&lt;/code&gt;ëŠ” tableì„ ì •ì˜í•  ë•Œ í•¨ê»˜ ëª…ì‹œí•˜ë©´ ë©ë‹ˆë‹¤. ì´ ì™¸ì—ë„ ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ ì™„ë²½í•˜ê²Œ ì‚¬ìš©í•˜ì‹¤ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://korcasus.github.io/p/hive-kafka-integration-1/easy.jpg&#34;
	width=&#34;420&#34;
	height=&#34;400&#34;
	srcset=&#34;https://korcasus.github.io/p/hive-kafka-integration-1/easy_huc8db540d4dfe2991afdf78060faa4427_62748_480x0_resize_q75_box.jpg 480w, https://korcasus.github.io/p/hive-kafka-integration-1/easy_huc8db540d4dfe2991afdf78060faa4427_62748_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ì°¸ì‰½ì£ &#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;105&#34;
		data-flex-basis=&#34;252px&#34;
	
&gt;&lt;br&gt;
ë‹¤ë§Œ Hiveì—ì„œ Kafkaì™€ ì—°ë™ëœ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ëª‡ê°€ì§€ ì£¼ì˜í•´ì•¼í•˜ëŠ” ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ì²«ë²ˆì§¸&lt;/code&gt;ë¡œëŠ” &lt;code&gt;EXTERNAL&lt;/code&gt; í…Œì´ë¸”ë¡œ ìƒì„±í•´ì•¼í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;br&gt;
ìš°ë¦¬ê°€ ì‚¬ìš©í•  ë°©ì‹ì€ Hiveì—ì„œ Kafkaì— ì ‘ê·¼í•˜ì—¬ ì €ì¥ëœ ë°ì´í„°ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì—, &lt;code&gt;EXTERNAL&lt;/code&gt; í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ë‘ë²ˆì§¸&lt;/code&gt;ë¡œëŠ” &lt;strong&gt;KafkaStorageHandler&lt;/strong&gt; ë¥¼ ëª…ì‹œí•´ì•¼í•©ë‹ˆë‹¤.&lt;br&gt;
í…Œì´ë¸”ì„ ì •ì˜í•  ë•Œ &lt;code&gt;STORED BY &#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&#39;&lt;/code&gt; ê°€ í•¨ê»˜ ì í˜€ìˆì–´ì•¼ í•©ë‹ˆë‹¤.&lt;br&gt;
ì í˜€ ìˆì–´ì•¼ë§Œ Kafkaë¥¼ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ì„¸ë²ˆì§¸&lt;/code&gt;ë¡œëŠ” í…Œì´ë¸”ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.&lt;br&gt;
&lt;code&gt;TBLPROPERTIES&lt;/code&gt; í‚¤ì›Œë“œ ì‚¬ìš©í•˜ë©´ í…Œì´ë¸”ì— ëŒ€í•œ Propertyë¥¼ ì„¤ì •í•  ìˆ˜ ìˆê²Œë©ë‹ˆë‹¤.
ì—¬ê¸°ì— Kafka ì—°ë™ì— í•„ìš”í•œ Configurationì„ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ì„¸ê°€ì§€ë¥¼ ëª¨ë‘ ì ìš©í•˜ì—¬ DDLì„ ì‘ì„±í•´ë³´ë©´, ì•„ë˜ì˜ ì˜ˆì‹œì²˜ëŸ¼ ë§Œë“¤ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kafka_table&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;timestamp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TIMESTAMP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STRING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;newPage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;BOOLEAN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;added&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;INT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;deleted&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;BIGINT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DOUBLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STORED&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;org.apache.hadoop.hive.kafka.KafkaStorageHandler&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;test-topic&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kafka.bootstrap.servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;localhost:9092&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;kafka-metadata&#34;&gt;Kafka metadata&lt;/h2&gt;
&lt;p&gt;Kafkaì— ì €ì¥ëœ MessageëŠ” Payload ì™¸ì—ë„ Key, Partition, Offset, Timestamp 4ê°œì˜ metadataê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
ì´ ë°ì´í„°ë“¤ë„ Hiveì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì•ì„œ í…Œì´ë¸”ì„ ì •ì˜í•  ë•Œ ì‚¬ìš©í•˜ì˜€ë˜ &lt;code&gt;KafkaStorageHandler&lt;/code&gt;ê°€ ìë™ìœ¼ë¡œ metadataë“¤ì„ ì»¬ëŸ¼ìœ¼ë¡œ ë“±ë¡í•´ ì¤ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;__key (byte array)&lt;/li&gt;
&lt;li&gt;__partition (int32)&lt;/li&gt;
&lt;li&gt;__offset (int64)&lt;/li&gt;
&lt;li&gt;__timestamp (int64)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;í™œìš©í•˜ëŠ” ë°©ì•ˆì€ ì‹¤ì‚¬ìš© ì˜ˆì œë¥¼ ì‘ì„±í•œ ë‹¤ìŒê¸€ì—ì„œ ìì„¸íˆ ì„¤ëª…ë“œë¦¬ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;avro-í¬ë§·-ì‚¬ìš©ì‹œ-ì£¼ì˜ì‚¬í•­&#34;&gt;Avro í¬ë§· ì‚¬ìš©ì‹œ ì£¼ì˜ì‚¬í•­&lt;/h2&gt;
&lt;p&gt;ë§Œì•½ Confluent Connectorë¥¼ í†µí•´ Avroí¬ë§·ì„ ì‚¬ìš©í•œë‹¤ë©´, ë©”ì‹œì§€ì—ì„œ 5-bytesë¥¼ ì œê±°í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.&lt;br&gt;
ì´ 5-bytesì¤‘ 1-byteëŠ” ë§¤ì§ byte, 4-byteëŠ” schema registryì˜ schema idì— í•´ë‹¹ë©ë‹ˆë‹¤.&lt;br&gt;
ì´ëŠ” &lt;code&gt;&amp;quot;avro.serde.type&amp;quot;=&amp;quot;skip&amp;quot;&lt;/code&gt; ê·¸ë¦¬ê³  &lt;code&gt;&amp;quot;avro.serde.skip.bytes&amp;quot;=&amp;quot;5&amp;quot;&lt;/code&gt;ë¥¼ ì„¤ì •í•´ì£¼ë©´ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
avroë¥¼ ì‚¬ìš©í•  ê²½ìš°, ìƒì„¸í•œ ë‚´ìš©ì€ ê°€ì´ë“œë¥¼ ê¼­ ì°¸ê³ í•˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;confluent avro format ì§€ì›ì€ Hive 4.0ë²„ì „ì— ì¶”ê°€ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
3.x ë²„ì „ì„ ì‚¬ìš©í•˜ì‹œëŠ” ë¶„ì´ë¼ë©´, ì£¼ì˜í•´ì£¼ì‹œë©´ ì¢‹ì„ê²ƒ ê°™ìŠµë‹ˆë‹¤. (ì œê°€ ì‚½ì§ˆí–ˆë˜ê±°ë¼ì„œìš”&amp;hellip;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;serdeserializer-deserializer&#34;&gt;Serde(Serializer, Deserializer)&lt;/h2&gt;
&lt;p&gt;Applicationì—ì„œ Kafkaë¡œ ë°ì´í„° ì „ì†¡ì„ í•´ë³¸ ì  ìˆë‹¤ë©´, serializer, deserializerë¥¼ ì§€ì •í•´ë³´ì‹  ê²½í—˜ì´ ìˆìœ¼ì‹¤ ê²ë‹ˆë‹¤.&lt;br&gt;
Hiveì—ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ ì—¬ëŸ¬ serializer, deserializerë¥¼ ì œê³µí•˜ê³ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Supported Serializers and Deserializers&lt;/th&gt;
&lt;th&gt;description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;org.apache.hadoop.hive.serde2.JsonSerDe&lt;/td&gt;
&lt;td&gt;JSON í¬ë§·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;org.apache.hadoop.hive.serde2.OpenCSVSerde&lt;/td&gt;
&lt;td&gt;CSV í¬ë§·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;org.apache.hadoop.hive.serde2.avro.AvroSerDe&lt;/td&gt;
&lt;td&gt;AVRO í¬ë§·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe&lt;/td&gt;
&lt;td&gt;binary..?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&lt;/td&gt;
&lt;td&gt;Plain Text&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ì§€ì •í•˜ëŠ” ë°©ë²•ì€ ìƒê°ë³´ë‹¤ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤.&lt;br&gt;
TBLPROPERTIESì— ì¶”ê°€í•˜ë©´ ì†ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì˜ˆë¥¼ ë“¤ë©´ Kafkaì—ì„œ ì½ì–´ë“¤ì¼ ë°ì´í„°í¬ë§·ì´ JSONì˜ ê²½ìš°ì´ê±°ë‚˜, ì „ì†¡í•  ë°ì´í„°ê°€ JSONìœ¼ë¡œ í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì²˜ëŸ¼ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.   &lt;br&gt;
&lt;code&gt;&amp;quot;kafka.serde.class&amp;quot; = &amp;quot;org.apache.hadoop.hive.serde2.JsonSerDe&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;ì¸ì¦&#34;&gt;ì¸ì¦&lt;/h2&gt;
&lt;p&gt;Kafkaì—ë„ ì¸ì¦ì„ í•´ì•¼ ë°ì´í„° ì½ê³  ì“¸ìˆ˜ ìˆëŠ” ê¶Œí•œì„ ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
Kafka ì‚¬ìš©í•˜ëŠ”ë° í•„ìš”í•œ ì¸ì¦ì •ë³´ë“¤ ë˜í•œ Hiveë¥¼ í†µí•´ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ì €ì˜ ê²½ìš°ì—ëŠ” ë³„ë„ë¡œ ì¸ì¦ì„ ì¶”ê°€í•˜ì§€ ì•Šê³  ì‚¬ìš©í–ˆë‹¤ë³´ë‹ˆ, ì¸ì¦ì—†ì´ ì‚¬ìš©í•œ ê²½ìš°ë¡œ ê¸°ë¡í•˜ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ì¸ì¦ì„ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ìƒí™©ì´ë¼ë©´, ê³µì‹ ë¬¸ì„œë¥¼ ì½ì–´ë³´ê³  ì§„í–‰í•´ ì£¼ì„¸ìš”.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ì¸ì¦ì„ ìœ„í•œ TBLPROPERTIES ê°’ì„ ì¶”ê°€í•˜ì§€ ì•Šì€ ìƒíƒœë¼ë©´, ì—°ê²°ì„ ì‹œë„í–ˆì„ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;br&gt;
ë³„ë„ì˜ ì„¤ì •ì„ ì•ˆí•´ë‘ì—ˆë‹¤ë©´, ë‹¹ì—°íˆ ì¸ì¦ì—†ì´ë„ ì‚¬ìš©ê°€ëŠ¥í•´ì•¼ë˜ëŠ”ê±° ì•„ë‹Œê°€? ë¼ê³  ìƒê°í•  ìˆ˜ ìˆì„í…ë°ìš”. (ì œê°€ ê·¸ë¬ìŠµë‹ˆë‹¤.)
HiveëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ id, passwordë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ì‹œë„í•˜ë ¤ í•©ë‹ˆë‹¤.&lt;br&gt;
ë”°ë¼ì„œ ì¸ì¦ì„ ì‚¬ìš©í•˜ì§€ì•ŠëŠ” ì„¤ì •ì„ ì¶”ê°€í•´ì£¼ì–´ì•¼ë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•œë°ìš”.&lt;/p&gt;
&lt;p&gt;ê³µì‹ë¬¸ì„œì— ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ë”°ë¡œ ì œì‹œí•˜ì§€ì•Šì•„ ë§ì´ ì–´ë ¤ì›€ì„ ê²ªì—ˆë˜ ë¶€ë¶„ì´ì—ˆìŠµë‹ˆë‹¤.   &lt;br&gt;
ê²°ë¡ ë¶€í„° ì´ì•¼ê¸°í•˜ë©´ TBLPROPERTYë¥¼ ì¶”ê°€í•˜ë©´ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;producerì¼ ê²½ìš° : &lt;code&gt;&amp;quot;kafka.producer.security.protocol&amp;quot; = &amp;quot;PLAINTEXT&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;consumerì¼ ê²½ìš° : &lt;code&gt;&amp;quot;kafka.consumer.security.protocol&amp;quot; = &amp;quot;PLAINTEXT&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì¸ì¦ì— ìƒì„¸íˆ ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´, &lt;a class=&#34;link&#34; href=&#34;https://kafka.apache.org/documentation/#producerconfigs_security.protocol&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ë¬¸ì„œ&lt;/a&gt;ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;br&gt;
í›„ì— ì„œìˆ í•˜ê² ì§€ë§Œ ì„¤ì •í• ë•Œ &lt;code&gt;kafka.&lt;/code&gt;ë¥¼ prefixë¡œ ì§€ì •í•´ë‘ë©´, kafkaì— ì„¤ì •ê°’ì´ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&#34;key-serializer&#34;&gt;Key Serializer&lt;/h2&gt;
&lt;p&gt;ì•ì„œ ì„¤ëª…ë“œë ¸ë˜ Serializerë“¤ì€ Value Serializer ì˜€ìŠµë‹ˆë‹¤.&lt;br&gt;
ì˜ˆìƒí•˜ë˜ê²ƒë³´ë‹¤ ë§ì´ ì œê³µí–ˆì§€ë§Œ ë°˜ëŒ€ë¡œ Key SerializerëŠ” Byte Serializerë°–ì— ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;br&gt;
ë‹¤ë¥¸ Serializerë¡œ ë³€ê²½í•´ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ë”ë¼ë„ ë³€ê²½í•  ìˆ˜ ì—†ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì™œ ì´ë ‡ê²Œ êµ¬í˜„í•œì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ, ìì„¸í•œ ë‚´ìš©ì€ ì½”ë“œë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ê¶ê¸ˆí•˜ì‹¤ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„, ë§í¬ë„ ì²¨ë¶€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/335749a33c02ec0dc7ebadb9eda101d174ad5faf/kafka-handler/src/java/org/apache/hadoop/hive/kafka/KafkaStorageHandler.java#L233&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;producer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/335749a33c02ec0dc7ebadb9eda101d174ad5faf/kafka-handler/src/java/org/apache/hadoop/hive/kafka/KafkaStorageHandler.java#L193&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;consumer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ê·¸ì™¸&#34;&gt;ê·¸ì™¸&lt;/h2&gt;
&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ì‘ì„±í•œ ë‚´ìš©ë“¤ ì´ì™¸ì—ë„ Kafkaë¥¼ ì‚¬ìš©í• ë•Œ, ì¶”ê°€í•˜ê³  ì‹¶ì€ ì„¤ì •ì´ ë” ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;br&gt;
ê³µì‹ë¬¸ì„œì—ì„œëŠ” ì„¤ëª…í•˜ì§„ ì•Šì§€ë§Œ, Kafkaì— ì‚¬ìš©í•  ì„¤ì •ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;producerë¡œ ì‚¬ìš©í•  ê²½ìš° &lt;code&gt;â€œkafka.producer.{property}â€ = â€œ{value}â€&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;consumerë¡œ ì‚¬ìš©í•  ê²½ìš° &lt;code&gt;â€œkafka.consumer.{property}â€ = â€œ{value}â€&lt;/code&gt;
TBLPROPERTIESì— ì¶”ê°€í•´ì£¼ë©´, Kafkaì— ì„¤ì •ê°’ë“¤ì´ ì „ë‹¬ë˜ë©° ì›í•˜ëŠ” ì„¤ì •ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ì–´ë–»ê²Œ ì„¤ì •ê°’ì´ ì „ë‹¬ë  ìˆ˜ ìˆëŠ”ì§€, êµ¬í˜„ëœ ì½”ë“œê°€ ê¶ê¸ˆí•˜ë‹¤ë©´ ì•„ë˜ì˜ ë§í¬ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/335749a33c02ec0dc7ebadb9eda101d174ad5faf/kafka-handler/src/java/org/apache/hadoop/hive/kafka/KafkaStorageHandler.java#L213&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;producer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/apache/hive/blob/335749a33c02ec0dc7ebadb9eda101d174ad5faf/kafka-handler/src/java/org/apache/hadoop/hive/kafka/KafkaStorageHandler.java#L168&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;consumer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ì •ë¦¬&#34;&gt;ì •ë¦¬&lt;/h2&gt;
&lt;p&gt;ì—¬ê¸°ê¹Œì§€ Hiveì—ì„œ Kafkaë¥¼ Read, Writeí•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•œ ì„¤ì •ë“¤ê³¼, ë„ì›€ì´ ë˜ëŠ” ì •ë³´ë“¤ì— ëŒ€í•´ ì•Œì•„ ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;br&gt;
ë‹¤ìŒ ê¸€ì—ì„œëŠ” Kafkaì— ìˆëŠ” Messageë“¤ì„ Hiveì—ì„œ Readí•˜ëŠ” ê³¼ì •ì„ ê¸°ë¡í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;br&gt;
ê°ì‚¬í•©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
